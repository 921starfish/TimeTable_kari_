<Page
    x:Name="pageRoot"
    x:Class="TimeTableOne.View.Pages.TablePage.TablePage"
    DataContext="{Binding DefaultViewModel, RelativeSource={RelativeSource Self}}"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:control="using:TimeTableOne.View.Pages.TablePage.Controls"
    xmlns:common="using:TimeTableOne.Common"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:tablePage="using:TimeTableOne.View.Pages.TablePage"
    xmlns:controls="using:TimeTableOne.View.Pages.DayPage.Controls"
    mc:Ignorable="d" d:DataContext="{tablePage:TablePageViewModelInDesign}">
    <Page.Resources>
        <ResourceDictionary Source="/Common/ColorDictionary.xaml"></ResourceDictionary>
    </Page.Resources>
    <Page.BottomAppBar>
        <CommandBar Name="BottomCommandBar">
            <AppBarButton Icon="Rotate"  Label="5/6/7列切替" Click="ToggleColumn"></AppBarButton>
            <AppBarButton Icon="Add" Label="一行追加" Click="AppendRow"></AppBarButton>
            <AppBarButton Icon="Remove" Label="一行消す" Name="RemoveButton"></AppBarButton>
        </CommandBar>
    </Page.BottomAppBar>
    <Grid MinHeight="768" MinWidth="1024" Background="{StaticResource OneNotePurple}">
    	<VisualStateManager.VisualStateGroups>
    		<VisualStateGroup x:Name="VisualStateGroup">
    			<VisualStateGroup.Transitions>
    				<VisualTransition From="BasicState" GeneratedDuration="0:0:0.3" To="MouseOn"/>
    				<VisualTransition GeneratedDuration="0:0:0.3"/>
    				<VisualTransition From="MouseOn" GeneratedDuration="0:0:0.3" To="Editing"/>
    			</VisualStateGroup.Transitions>
    			<VisualState x:Name="BasicState"/>
    			<VisualState x:Name="MouseOn">
    				<Storyboard>
    					<DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="symbolIcon" d:IsOptimized="True"/>
    				</Storyboard>
    			</VisualState>
    			<VisualState x:Name="Editing">
    				<Storyboard>
    					<ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="textBox">
    						<DiscreteObjectKeyFrame KeyTime="0">
    							<DiscreteObjectKeyFrame.Value>
    								<Visibility>Visible</Visibility>
    							</DiscreteObjectKeyFrame.Value>
    						</DiscreteObjectKeyFrame>
    					</ObjectAnimationUsingKeyFrames>
    					<ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="pageTitle">
    						<DiscreteObjectKeyFrame KeyTime="0">
    							<DiscreteObjectKeyFrame.Value>
    								<Visibility>Collapsed</Visibility>
    							</DiscreteObjectKeyFrame.Value>
    						</DiscreteObjectKeyFrame>
    					</ObjectAnimationUsingKeyFrames>
    					<DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="textBox" d:IsOptimized="True"/>
    				</Storyboard>
    			</VisualState>
    		</VisualStateGroup>
    	</VisualStateManager.VisualStateGroups>
        <Grid.RowDefinitions>
            <RowDefinition Height="120"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid Grid.Row="0" Loaded="Grid_Loaded">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="120"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="120"/>
            </Grid.ColumnDefinitions>
            <Button x:Name="backButton"  HorizontalAlignment="Stretch"  
                    VerticalAlignment="Stretch" 
                        Click="BackButton_OnClick"
                        Style="{StaticResource NavigationBackButtonNormalStyle}"
                        AutomationProperties.Name="Back"
                        AutomationProperties.AutomationId="BackButton"
                        AutomationProperties.ItemType="Navigation Button" />
            <StackPanel Grid.Column="1" Orientation="Horizontal">
                <TextBlock x:Name="pageTitle" 
                       Text="{Binding PageTitle}"
                       Style="{StaticResource HeaderTextBlockStyle}" 
                       IsHitTestVisible="True" 
                       TextWrapping="NoWrap" 
                       VerticalAlignment="Center" 
                       HorizontalAlignment="Left" Opacity="1"  PointerEntered="PageTitle_OnPointerEntered" PointerExited="PageTitle_OnPointerExited" PointerPressed="PageTitle_OnPointerPressed"/>
                <TextBox Text="{Binding PageTitleForEdit,Mode=TwoWay}" x:Name="textBox" Width="300" Height="20" Visibility="Collapsed" Opacity="0" LostFocus="TextBox_OnLostFocus"/>
                <SymbolIcon x:Name="symbolIcon" Symbol="Edit" Margin="4,0,0,0" Opacity="0"></SymbolIcon>
            </StackPanel>
            
            <controls:TimeControl Grid.Column="1" HorizontalAlignment="Right" VerticalAlignment="Center" d:DataContext="{controls:TimeControlViewModel}"/>
            <Button Grid.Column="2" VerticalContentAlignment="Center" HorizontalAlignment="Center" Click="ButtonBase_OnClick">
                <SymbolIcon Symbol="Setting"></SymbolIcon>
            </Button>
        </Grid>
        <control:TimeTableGrid x:Name="GridControl" Grid.Row="1" d:DataContext="{control:TimeTableGridViewModelInDesign}" DataContext="{Binding TimeTableDataContext}" FontFamily="Global User Interface">
            
        </control:TimeTableGrid>
    </Grid>
</Page>
